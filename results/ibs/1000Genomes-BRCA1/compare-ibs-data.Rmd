# Comparing Two Identity By State (IBS) Matrices

```{r echo=FALSE, eval=FALSE}
# This codelab assumes that the current working directory is where the Rmd file
# resides
setwd("/YOUR/PATH/TO//1000Genomes-BRCA1/ibs")
```

This script takes two file names `ibsFilename1` and `ibsFilename2` as input.
Each input file should contain an N^2 * 3 matrix, where N is the size of the
population and each row represents the IBS score for a pair of individuals.

```{r message=FALSE, comment=NA}
library(reshape2)
ReadIBS <- function(ibsFilename) {
  ibsData <- read.table(file=ibsFilename, stringsAsFactors=FALSE)
  colnames(ibsData) <- c("sample1", "sample2", "ibsScore")
  return (ibsData)
}
ibsData1 <- ReadIBS(ibsFilename1)
ibsData2 <- ReadIBS(ibsFilename2)
```

Compare the two IBS matrices and report the differences.

```{r message=FALSE, comment=NA}
mergedIBS <- merge(ibsData1, ibsData2, by = c(colnames(ibsData1)[1:2]))
diffIBS <- abs(mergedIBS$ibsScore.x - mergedIBS$ibsScore.y) < 1e-6
mergedDiffIBS <- cbind(mergedIBS, diffIBS)
colnames(mergedDiffIBS) <- c(colnames(mergedDiffIBS)[1:4],
                               "almostEqualIBS")
dim(mergedDiffIBS[mergedDiffIBS$almostEqualIBS == FALSE,])
```

